#!/bin/bash
configure=""
debug="-d"
target="0.28.2"
arch=""
dist="https://atom.io/download/atom-shell"
plat=`uname`

if [ $plat == 'Linux' ] || [ $plat == 'Darwin' ]; then
  msvs=""
else
  msvs="--msvs_version=2013"
fi

while [[ $# > 0 ]]
do
key="$1"
case $key in
    # configure
    -c|--configure|configure)
    configure="configure"
    ;;

    #debug
    -r|--release|release)
    debug=""
    ;;

    -d|--debug|debug)
    debug="-d" # default
    ;;

    -t|--target)
    target="$2"
    shift
    ;;

    -D|--dist|--dist-url)
    dist="$2"
    shift
    ;;

    --msvs)
    msvs="$2"
    shift
    ;;

    #arch
    -x86|x86)
    arch="--arch=ia32"
    ;;
    -x64|x64)
    arch="" # default
    ;;

    # unknown option
    *) 
    echo "Unknown option: $i"
    exit 1
    ;;
esac
shift
done

HOME=~/.electron-gyp node-gyp --target="${target}" ${msvs} ${arch} ${debug} --dist-url=${dist} ${configure} build